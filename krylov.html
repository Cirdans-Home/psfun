

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Krylov Module &mdash; PSFUN 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Library Usage Examples" href="examples.html" />
    <link rel="prev" title="Serial Module" href="serial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PSFUN
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="psfunlibrary.html">Matrix Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="serial.html">Serial Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Krylov Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stopping-criterion">Stopping Criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#f/psfun_d_krylov_mod">Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Library Usage Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PSFUN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Krylov Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/krylov.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="krylov-module">
<h1>Krylov Module<a class="headerlink" href="#krylov-module" title="Permalink to this headline">¶</a></h1>
<p>Let <img class="math" src="_images/math/ba47a3393a624d1d3611eddcf4e1a769b165e236.png" alt="V_{k}"/> be an orthogonal matrix whose columns <img class="math" src="_images/math/db0eb6b3d80a5854fdbf7c4238eec897c60c1f07.png" alt="\mathbf{x}_{1},\dots, \mathbf{x}_{k}"/>
span an arbitrary Krylov subspace <img class="math" src="_images/math/c41e7f8f144f5f3dfde624f3e12f0d3e23b9eb3b.png" alt="\mathcal{W}_{k}(A,\mathbf{x})"/> of
dimension <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/>. We obtain an approximation of <img class="math" src="_images/math/b404b9727217fa5204a059c35d214c3102f03038.png" alt="f(A)\mathbf{x}"/> by</p>
<div class="math" id="equation-krylov-fa-approx">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-krylov-fa-approx" title="Permalink to this equation">¶</a></span><img src="_images/math/ecdcfa8dbbfb05cadc1d6672d0a2ae1eec0bfe31.png" alt="f(A)\mathbf{x} = V_{k}f(V_{k}^{T}AV_{k})V_{k}^{T}\mathbf{x}."/></p>
</div><p>Different methods for the approximation of matrix functions are obtained for
different choices of the projection spaces <img class="math" src="_images/math/c41e7f8f144f5f3dfde624f3e12f0d3e23b9eb3b.png" alt="\mathcal{W}_{k}(A,\mathbf{x})"/>.</p>
<p>Given a set of scalars <img class="math" src="_images/math/78bef62d054e5247aef5b3f81966c7023b0e1d45.png" alt="\left\{ \sigma _{1},\dots,\sigma _{k-1}\right\} \subset \overline{\mathbb{C}}"/>
in the the extended complex plane <img class="math" src="_images/math/a2c3d3906a17d8e2b51607f6e1ecb10525bea374.png" alt="\overline{\mathbb{C}}"/>, that are not
eigenvalues of <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/>, let</p>
<div class="math">
<p><img src="_images/math/7e3c6729dcb44713c7f0b873bd3adf758762e74f.png" alt="q_{k-1}(z)=\prod\nolimits_{j=1}^{k-1}(\sigma _{j}-z)."/></p>
</div><p>The <strong>rational Krylov</strong> subspace of order <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/> associated with <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/>,
<img class="math" src="_images/math/5369e693370bbbd19fea43055b8f96596bff42a6.png" alt="\mathbf{x}"/> and <img class="math" src="_images/math/528721f5377295392cda9c8f9c0cb4a00eb5bddb.png" alt="q_{k-1}"/> is defined by</p>
<div class="math">
<p><img src="_images/math/5f125e0363aabb3b64c10f94e0bc97981fcfd158.png" alt="\mathcal{Q}_{k}(A,\mathbf{x})=\left[ q_{k-1}(A)\right] ^{-1}\mathcal{K}_{k}(A,\mathbf{x}),"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/c91baf73c876db5bea7eba89c80b0142b64a0e8e.png" alt="\mathcal{K}_{k}(A,\mathbf{x})=\operatorname{Span}\{\mathbf{x},A\mathbf{x},\ldots ,A^{k-1}\mathbf{x}\}"/></p>
</div><p>is the standard polynomial Krylov space.</p>
<p>By defining the matrices</p>
<div class="math">
<p><img src="_images/math/ddebc25b3a3e9a3c627f0be6fd9ccdb0eaa4074c.png" alt="C_{j}=\left( \mu _{j}\sigma _{j}A-I\right) (\sigma _{j}I-A)^{-1},"/></p>
</div><p>where <img class="math" src="_images/math/7d2828a13819acc0ffc9aa2b2872d651f0a74b38.png" alt="\left\{ \mu _{1},\dots, \mu _{k-1}\right\} \subset \overline{\mathbb{C}}"/>
are such that <img class="math" src="_images/math/f638adbf89c3cfa4194ea8ccf82ed6a72e38fa69.png" alt="\sigma _{j}\neq $ $\mu _{j}^{-2}"/>, it is known that the
rational Krylov space can also be written as follows <a class="bibtex reference internal" href="zreferences.html#guttel2013rational" id="id1">[2]</a></p>
<div class="math">
<p><img src="_images/math/de69f8bd53bba9b42ad53670af786c5a104eed82.png" alt="\mathcal{Q}_{k}(A,\mathbf{x})=\operatorname{Span}\{\mathbf{x},C_{1}\mathbf{x},\ldots ,C_{k-1}\cdots C_2 C_{1}\mathbf{x}\}."/></p>
</div><p>This general formulation allows to recast most of the classical Krylov
methods in terms of a rational Krylov method with a specific choice of <img class="math" src="_images/math/6e72183dd7a88126ab98c30a1790ab896d2706e0.png" alt="\sigma _{j}"/>
and <img class="math" src="_images/math/ba42fac84c10df814911cffa85c371dec15ec054.png" alt="\mu _{j}"/>. In particular,</p>
<blockquote>
<div><ul>
<li><p>the <strong>polynomial Krylov</strong> method in which <img class="math" src="_images/math/e3b9a0800c0987b340888af792ac34d4a2c34a1c.png" alt="\mathcal{W}_{k}(A,\mathbf{x})=\mathcal{K}_{k}(A,\mathbf{x})"/>
can be recovered by defining <img class="math" src="_images/math/5912f08646b0e2ec8acd90d310910773ce1f9b6d.png" alt="\mu _{j}=1"/> and <img class="math" src="_images/math/1beab5c20a369b1d89cb36676fc152b294f2e35b.png" alt="\sigma_{j}=\infty"/> for each <cite>j</cite>.</p></li>
<li><p>The <strong>extended Krylov</strong> method <a class="bibtex reference internal" href="zreferences.html#eksm1" id="id2">[1]</a><a class="bibtex reference internal" href="zreferences.html#eksm2" id="id3">[4]</a>, in which</p>
<div class="math">
<p><img src="_images/math/03b32626a83de67404b328e10b451a45531555ce.png" alt="\mathcal{W}_{2k-1}(A,\mathbf{x})=\operatorname{Span}\{\mathbf{x}, A^{-1}\mathbf{x}, A\mathbf{x}, \ldots, A^{-(k-1)}\mathbf{x}, A^{k-1}\mathbf{x}\},"/></p>
</div><p>is obtained by setting</p>
<div class="math">
<p><img src="_images/math/5a4b19eeb36699f6dc6830f3d9e7f7f2c863ef39.png" alt="(\mu _j,\sigma_j)= \left\lbrace \begin{array}{ll} (1,\infty), &amp; \mbox{for  $j$ even},\\ (0,0),  &amp; \mbox{for  $j$  odd.} \end{array}\right."/></p>
</div></li>
<li><p>The <strong>shift-and-invert</strong> rational Krylov <a class="bibtex reference internal" href="zreferences.html#moret2004rd" id="id4">[8]</a><a class="bibtex reference internal" href="zreferences.html#van2006preconditioning" id="id5">[11]</a>, where</p>
<div class="math">
<p><img src="_images/math/a703d6dc7ee83f5f3d47330c1b77c4ce60ec361b.png" alt="\mathcal{W}_{k}(A,\mathbf{x})=\operatorname{Span}\{\mathbf{x},(\sigma I-A)^{-1}\mathbf{x},\ldots ,(\sigma I-A)^{-(k-1)}\mathbf{x}\},"/></p>
</div><p>is defined by taking <img class="math" src="_images/math/59d971b5a8c15f24a07dd7b26e55d518f4480844.png" alt="\mu _{j}=0"/> and <img class="math" src="_images/math/72e762d21bb9105f828724e5ddb0998750cd8e56.png" alt="\sigma _{j}=\sigma"/> for each <img class="math" src="_images/math/e3fc28292267f066fee7718c64f4bbfece521f24.png" alt="j"/>.</p>
</li>
</ul>
</div></blockquote>
<p>The PSFUN library contains the implementation of several flavour of these methods
that can be used for the computation of <a class="reference internal" href="#equation-krylov-fa-approx">(3)</a>, the field
in the <code class="code fortran docutils literal notranslate"><span class="pre">psfun_d_krylov</span></code> type represent the options neeeded to for setting
up and applying the different implemented method for a given matrix function
<code class="code fortran docutils literal notranslate"><span class="pre">fun</span></code> (represented by an object of type <code class="code fortran docutils literal notranslate"><span class="pre">psfun_d_serial</span></code>).</p>
<p><a class="reference internal" href="#implemented-krylov-methods"><span class="std std-numref">Table 2</span></a> has the info on the method available.</p>
<table class="colwidths-given docutils align-default" id="implemented-krylov-methods">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Implemented Krylov Methods</span><a class="headerlink" href="#implemented-krylov-methods" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Class</p></th>
<th class="head"><p>Matrix Type</p></th>
<th class="head"><p><code class="code fortran docutils literal notranslate"><span class="pre">kname</span></code></p></th>
<th class="head"><p>Source</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Arnoldi</p></td>
<td><p>Polynomial</p></td>
<td><p>General</p></td>
<td><p><code class="code fortran docutils literal notranslate"><span class="pre">&quot;ARNOLDI&quot;</span></code></p></td>
<td><p><a class="bibtex reference internal" href="zreferences.html#mr1149094" id="id6">[9]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Lanczos</p></td>
<td><p>Polynomial</p></td>
<td><p>Symmetric</p></td>
<td><p><code class="code fortran docutils literal notranslate"><span class="pre">&quot;LANCZOS&quot;</span></code></p></td>
<td><p><a class="bibtex reference internal" href="zreferences.html#mr1149094" id="id7">[9]</a></p></td>
</tr>
</tbody>
</table>
<div class="section" id="stopping-criterion">
<h2>Stopping Criterion<a class="headerlink" href="#stopping-criterion" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="f/psfun_d_krylov_mod">
<span id="module"></span><h2>Module<a class="headerlink" href="#f/psfun_d_krylov_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>The psfun_d_krylov_mod contains the generic call to a Krylov subspace
method for the computation of <img class="math" src="_images/math/1c6810dd0f85abc08cf88e723b9e381816479518.png" alt="y = f(A) x"/>, for <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> large and
sparse.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/psfun_d_krylov_mod/psfun_d_parallel_apply" title="f/psfun_d_krylov_mod/psfun_d_parallel_apply"><code class="xref f f-func docutils literal notranslate"><span class="pre">psfun_d_parallel_apply()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">psb_base_mod</span></code></p></li>
<li><p><a class="reference internal" href="serial.html#f/psfun_d_serial_mod" title="f/psfun_d_serial_mod: This module contains the generic interfaces for the computation of the different matrix functions included in the library. The idea is that this modules computes, in a serial way, :math:`y = f(\alpha A)x`...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">psfun_d_serial_mod</span></code></a>: This module contains the generic interfaces for the computation of the different matrix functions included in the library. The idea is that this modules computes, in a serial way, <img class="math" src="_images/math/1e883674d401c5aa0e8d2155075245bc42331fde.png" alt="y = f(\alpha A)x"/>….</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/psfun_d_krylov_mod/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">psfun_d_krylov_mod/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/psfun_d_krylov_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">kname</code><em> [</em><em>character</em><em>,</em><em>optional/default=’arnoldi’</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/psfun_d_krylov_mod/psfun_d_setstring">
<em class="property">subroutine  </em><code class="sig-prename descclassname">psfun_d_krylov_mod/</code><code class="sig-name descname">psfun_d_setstring</code><span class="sig-paren">(</span><em class="sig-param">meth</em>, <em class="sig-param">what</em>, <em class="sig-param">val</em>, <em class="sig-param">info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/psfun_d_krylov_mod/psfun_d_setstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Set function for setting options defined by a string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meth</strong></p></li>
<li><p><strong>what</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>val</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Use </dt>
<dd class="field-even"><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">psb_base_mod</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/psfun_d_krylov_mod/psfun_d_parallel_apply">
<em class="property">subroutine  </em><code class="sig-prename descclassname">psfun_d_krylov_mod/</code><code class="sig-name descname">psfun_d_parallel_apply</code><span class="sig-paren">(</span><em class="sig-param">meth</em>, <em class="sig-param">fun</em>, <em class="sig-param">a</em>, <em class="sig-param">desc_a</em>, <em class="sig-param">y</em>, <em class="sig-param">x</em>, <em class="sig-param">eps</em>, <em class="sig-param">info</em><span class="optional">[</span>, <em class="sig-param">itmax</em><span class="optional">[</span>, <em class="sig-param">itrace</em><span class="optional">[</span>, <em class="sig-param">istop</em><span class="optional">[</span>, <em class="sig-param">iter</em><span class="optional">[</span>, <em class="sig-param">err</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/psfun_d_krylov_mod/psfun_d_parallel_apply" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the generic function for applying every implemented Krylov
method. The general iteration parameters (like the number of iteration,
the stop criterion to be used, and the verbosity of the trace) can be
passed directly to this routine. All the constitutive parameters of
the actual method, and the information relative to the function are
instead contained in the meth and fun objects. The Descriptor object
:p psb_desc_type desc_a [in]: Descriptor for the sparse matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meth</strong> :: Krylov method object</p></li>
<li><p><strong>fun</strong><em> [</em><em>psfun_d_serial</em><em>,</em><em>inout</em><em>]</em> :: Function object</p></li>
<li><p><strong>a</strong><em> [</em><em>psb_dspmat_type</em><em>,</em><em>in</em><em>]</em> :: Distribute sparse matrix</p></li>
<li><p><strong>y</strong><em> [</em><em>psb_d_vect_type</em><em>,</em><em>inout</em><em>]</em> :: Output vector</p></li>
<li><p><strong>x</strong><em> [</em><em>psb_d_vect_type</em><em>,</em><em>inout</em><em>]</em> :: Input vector</p></li>
<li><p><strong>eps</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Requested tolerance</p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em> :: Output flag</p></li>
<li><p><strong>itmax</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: Maximum number of iteration</p></li>
<li><p><strong>itrace</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: Trace for logoutput</p></li>
<li><p><strong>istop</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: Stop criterion</p></li>
<li><p><strong>iter</strong><em> [</em><em>integer</em><em>,</em><em>out,</em><em>]</em> :: Number of iteration</p></li>
<li><p><strong>err</strong><em> [</em><em>real</em><em>,</em><em>out,</em><em>]</em> :: Last estimate error</p></li>
</ul>
</dd>
<dt class="field-even">Use </dt>
<dd class="field-even"><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">psb_base_mod</span></code>, <a class="reference internal" href="serial.html#f/psfun_d_serial_mod" title="f/psfun_d_serial_mod: This module contains the generic interfaces for the computation of the different matrix functions included in the library. The idea is that this modules computes, in a serial way, :math:`y = f(\alpha A)x`...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">psfun_d_serial_mod</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="Library Usage Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="serial.html" class="btn btn-neutral float-left" title="Serial Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Fabio Durastante

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>