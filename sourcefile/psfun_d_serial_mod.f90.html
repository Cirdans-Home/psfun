<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A library for distributed computation of matrix functions powered by PSCTOOLKIT PSFUN Parallel Sparse Function">
    
    <meta name="author" content="Fabio Durastante" >
    <link rel="icon" href="../favicon.png">

    <title>psfun_d_serial_mod.F90 &ndash; PSFUN</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">PSFUN <small>0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Matrix Functions</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>psfun_d_serial_mod.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="11.8% of total for source files.">368 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/psfun_d_serial_mod.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">psfun_d_serial_mod.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/psfun_d_serial_mod.html">psfun_d_serial_mod</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/psfun_d_serial_mod.f90.html#src">psfun_d_serial_mod.F90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilepsfun_d_serial_modf90AfferentGraph" width="455pt" height="200pt"
 viewBox="0.00 0.00 455.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-196 451,-196 451,4 -4,4"/>
<!-- sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~psfun_d_serial_mod.f90</title>
<polygon fill="none" stroke="#000000" points="131,-109 0,-109 0,-85 131,-85 131,-109"/>
<text text-anchor="middle" x="65.5" y="-94.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">psfun_d_serial_mod.F90</text>
</g>
<!-- sourcefile~psfun_d_arnoldi.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~psfun_d_arnoldi.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/psfun_d_arnoldi.f90.html" xlink:title="psfun_d_arnoldi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445,-192 338,-192 338,-168 445,-168 445,-192"/>
<text text-anchor="middle" x="391.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psfun_d_arnoldi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~psfun_d_arnoldi.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~psfun_d_arnoldi.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M337.7543,-183.342C307.0213,-184.2522 267.8676,-183.7153 233.5,-178"/>
</g>
<!-- sourcefile~psfun_d_krylov_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~psfun_d_krylov_mod.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/psfun_d_krylov_mod.f90.html" xlink:title="psfun_d_krylov_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="300,-149 167,-149 167,-125 300,-125 300,-149"/>
<text text-anchor="middle" x="233.5" y="-134.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psfun_d_krylov_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~psfun_d_arnoldi.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~psfun_d_arnoldi.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M347.0677,-167.9077C328.569,-162.8732 306.9203,-156.9815 287.514,-151.7"/>
<polygon fill="#4800ff" stroke="#4800ff" points="288.1669,-148.2505 277.5988,-149.0016 286.3287,-155.0048 288.1669,-148.2505"/>
</g>
<!-- sourcefile~lanczostest.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~lanczostest.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/lanczostest.f90.html" xlink:title="lanczostest.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="435.5,-150 347.5,-150 347.5,-126 435.5,-126 435.5,-150"/>
<text text-anchor="middle" x="391.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">lanczostest.F90</text>
</a>
</g>
</g>
<!-- sourcefile~lanczostest.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~lanczostest.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M357.3311,-150.0783C318.3886,-163.2337 257.0862,-181.9224 233.5,-178"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M233.5,-178C203.0548,-172.937 195.223,-170.4902 167,-158 139.9365,-146.0229 111.2152,-128.2275 91.258,-114.9443"/>
<polygon fill="#ff0000" stroke="#ff0000" points="92.9892,-111.8901 82.7426,-109.1959 89.0726,-117.6919 92.9892,-111.8901"/>
</g>
<!-- sourcefile~lanczostest.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~lanczostest.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M347.4882,-137.7214C335.8882,-137.648 323.027,-137.5666 310.2445,-137.4857"/>
<polygon fill="#4800ff" stroke="#4800ff" points="310.0578,-133.9846 300.0358,-137.4211 310.0134,-140.9844 310.0578,-133.9846"/>
</g>
<!-- sourcefile~arnolditest.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~arnolditest.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/arnolditest.f90.html" xlink:title="arnolditest.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="433.5,-108 349.5,-108 349.5,-84 433.5,-84 433.5,-108"/>
<text text-anchor="middle" x="391.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">arnolditest.F90</text>
</a>
</g>
</g>
<!-- sourcefile~arnolditest.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~arnolditest.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M349.2154,-96.1297C296.6399,-96.291 205.9442,-96.5692 141.2492,-96.7676"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.0883,-93.268 131.0991,-96.7988 141.1098,-100.268 141.0883,-93.268"/>
</g>
<!-- sourcefile~arnolditest.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~arnolditest.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M349.1589,-106.9872C330.8606,-111.7355 309.1909,-117.3587 289.583,-122.4468"/>
<polygon fill="#4800ff" stroke="#4800ff" points="288.6479,-119.0735 279.8476,-124.9731 290.4062,-125.8491 288.6479,-119.0735"/>
</g>
<!-- sourcefile~psfun_d_sai.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~psfun_d_sai.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/psfun_d_sai.f90.html" xlink:title="psfun_d_sai.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="435.5,-66 347.5,-66 347.5,-42 435.5,-42 435.5,-66"/>
<text text-anchor="middle" x="391.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psfun_d_sai.f90</text>
</a>
</g>
</g>
<!-- sourcefile~psfun_d_sai.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~psfun_d_sai.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M354.8354,-41.9035C315.7753,-29.6468 256.4699,-13.0157 233.5,-17"/>
</g>
<!-- sourcefile~psfun_d_sai.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~psfun_d_sai.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M356.7436,-66.036C349.7751,-68.7591 342.5772,-71.7996 336,-75 309.1211,-88.0791 280.114,-106.0155 259.8413,-119.2322"/>
<polygon fill="#4800ff" stroke="#4800ff" points="257.8766,-116.3353 251.4504,-124.7586 261.7269,-122.1813 257.8766,-116.3353"/>
</g>
<!-- sourcefile~serialtest.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~serialtest.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/serialtest.f90.html" xlink:title="serialtest.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="270,-69 197,-69 197,-45 270,-45 270,-69"/>
<text text-anchor="middle" x="233.5" y="-54.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">serialtest.f90</text>
</a>
</g>
</g>
<!-- sourcefile~serialtest.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~serialtest.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M196.6317,-65.7782C175.9254,-70.7082 149.5699,-76.9834 125.9257,-82.6129"/>
<polygon fill="#ff0000" stroke="#ff0000" points="124.9003,-79.2592 115.9829,-84.9803 126.5217,-86.0688 124.9003,-79.2592"/>
</g>
<!-- sourcefile~psfun_d_krylov_mod.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~psfun_d_krylov_mod.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M183.0945,-124.9987C165.1524,-120.7268 144.7622,-115.8719 126.0577,-111.4185"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.6988,-107.9734 116.1601,-109.0619 125.0774,-114.783 126.6988,-107.9734"/>
</g>
<!-- sourcefile~psfun_d_lanczos.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~psfun_d_lanczos.f90</title>
<g id="a_sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/psfun_d_lanczos.f90.html" xlink:title="psfun_d_lanczos.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447,-24 336,-24 336,0 447,0 447,-24"/>
<text text-anchor="middle" x="391.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psfun_d_lanczos.f90</text>
</a>
</g>
</g>
<!-- sourcefile~psfun_d_lanczos.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~psfun_d_lanczos.f90&#45;&gt;sourcefile~psfun_d_serial_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M335.9093,-9.9801C305.4554,-9.8182 267.1654,-11.1605 233.5,-17"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M233.5,-17C203.214,-22.2533 195.1941,-23.7553 167,-36 139.6907,-47.8604 110.7972,-65.8232 90.8515,-79.1884"/>
<polygon fill="#ff0000" stroke="#ff0000" points="88.6551,-76.4494 82.3547,-84.9673 92.5918,-82.2375 88.6551,-76.4494"/>
</g>
<!-- sourcefile~psfun_d_lanczos.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90 -->
<g id="sourcefile~~psfun_d_serial_mod.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~psfun_d_lanczos.f90&#45;&gt;sourcefile~psfun_d_krylov_mod.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M351.6376,-24.0784C346.1342,-26.5885 340.7487,-29.5457 336,-33 315.2877,-48.0665 317.6434,-59.4336 300,-78 286.353,-92.3609 269.6728,-107.1536 256.4321,-118.3346"/>
<polygon fill="#4800ff" stroke="#4800ff" points="254.1267,-115.6997 248.6902,-124.7934 258.611,-121.0748 254.1267,-115.6997"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/psfun_d_serial_mod.html">psfun_d_serial_mod</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/psfun_d_serial_mod.f90.html#src">psfun_d_serial_mod.F90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! BSD 3-Clause License</span>
<a name="ln-2"></a><span class="c">!</span>
<a name="ln-3"></a><span class="c">! Copyright (c) 2020, Fabio Durastante</span>
<a name="ln-4"></a><span class="c">! All rights reserved.</span>
<a name="ln-5"></a><span class="c">!</span>
<a name="ln-6"></a><span class="c">! Redistribution and use in source and binary forms, with or without</span>
<a name="ln-7"></a><span class="c">! modification, are permitted provided that the following conditions are met:</span>
<a name="ln-8"></a><span class="c">!</span>
<a name="ln-9"></a><span class="c">! 1. Redistributions of source code must retain the above copyright notice, this</span>
<a name="ln-10"></a><span class="c">!    list of conditions and the following disclaimer.</span>
<a name="ln-11"></a><span class="c">!</span>
<a name="ln-12"></a><span class="c">! 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<a name="ln-13"></a><span class="c">!    this list of conditions and the following disclaimer in the documentation</span>
<a name="ln-14"></a><span class="c">!    and/or other materials provided with the distribution.</span>
<a name="ln-15"></a><span class="c">!</span>
<a name="ln-16"></a><span class="c">! 3. Neither the name of the copyright holder nor the names of its</span>
<a name="ln-17"></a><span class="c">!    contributors may be used to endorse or promote products derived from</span>
<a name="ln-18"></a><span class="c">!    this software without specific prior written permission.</span>
<a name="ln-19"></a><span class="c">!</span>
<a name="ln-20"></a><span class="c">! THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<a name="ln-21"></a><span class="c">! AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="ln-22"></a><span class="c">! IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="ln-23"></a><span class="c">! DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<a name="ln-24"></a><span class="c">! FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="ln-25"></a><span class="c">! DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<a name="ln-26"></a><span class="c">! SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<a name="ln-27"></a><span class="c">! CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<a name="ln-28"></a><span class="c">! OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="ln-29"></a><span class="c">! OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="ln-30"></a><span class="k">module </span><span class="n">psfun_d_serial_mod</span>
<a name="ln-31"></a>    <span class="c">!! This module contains the generic interfaces for the computation of the</span>
<a name="ln-32"></a>    <span class="c">!! different matrix functions included in the library. The idea is that this</span>
<a name="ln-33"></a>    <span class="c">!! modules computes, in a serial way, \(y = f(\alpha A)x\).</span>
<a name="ln-34"></a>
<a name="ln-35"></a>    <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-36"></a><span class="cp">#if defined(WITHPHILIBRARY)</span>
<a name="ln-37"></a>    <span class="k">use </span><span class="n">scalesquare</span> <span class="c">!| loaded only if compiled with PHI-FUNCTION library</span>
<a name="ln-38"></a><span class="cp">#endif</span>
<a name="ln-39"></a>
<a name="ln-40"></a>
<a name="ln-41"></a>    <span class="k">implicit none</span>
<a name="ln-42"></a>
<a name="ln-43"></a><span class="k">    type</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">psfun_d_serial</span>
<a name="ln-44"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">fname</span>   <span class="o">=</span> <span class="s1">&#39;EXP&#39;</span>  <span class="c">!! Name of the function</span>
<a name="ln-45"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">variant</span> <span class="o">=</span> <span class="s1">&#39;EXPOKIT&#39;</span> <span class="c">!! Implementatio variant</span>
<a name="ln-46"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">scaling</span> <span class="o">=</span> <span class="mf">1.0_psb_dpk_</span> <span class="c">!! \(\alpha\) of \(f(\alpha A)v\)</span>
<a name="ln-47"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">padedegree</span> <span class="o">=</span> <span class="mi">6_psb_ipk_</span> <span class="c">!! Degree of Pad√© expansion</span>
<a name="ln-48"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">phiorder</span> <span class="o">=</span> <span class="mi">1_psb_ipk_</span> <span class="c">!! Order of the \(\varphi\)-function</span>
<a name="ln-49"></a>        <span class="k">procedure</span> <span class="p">(</span><span class="n">func</span><span class="p">),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">nopass</span> <span class="kd">::</span> <span class="n">f_ptr</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span> <span class="c">!! Pointer of a function \(f(x,k) = f^{(k)}(x)\)</span>
<a name="ln-50"></a>    <span class="k">contains</span>
<a name="ln-51"></a>        <span class="c">! Set the options</span>
<a name="ln-52"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="kd">::</span> <span class="n">setstring</span>  <span class="o">=&gt;</span> <span class="n">psfun_d_setstring</span>
<a name="ln-53"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="kd">::</span> <span class="n">setreal</span>    <span class="o">=&gt;</span> <span class="n">psfun_d_setreal</span>
<a name="ln-54"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="kd">::</span> <span class="n">setinteger</span> <span class="o">=&gt;</span> <span class="n">psfun_d_setinteger</span>
<a name="ln-55"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="kd">::</span> <span class="n">setfunction</span> <span class="o">=&gt;</span> <span class="n">psfun_d_setpointer</span>
<a name="ln-56"></a>        <span class="k">generic</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">set</span> <span class="o">=&gt;</span> <span class="n">setstring</span><span class="p">,</span> <span class="n">setreal</span><span class="p">,</span> <span class="n">setinteger</span><span class="p">,</span> <span class="n">setfunction</span>
<a name="ln-57"></a>        <span class="c">! Computes the function</span>
<a name="ln-58"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="kd">::</span> <span class="n">applya</span>      <span class="o">=&gt;</span> <span class="n">psfun_d_serial_apply_array</span>
<a name="ln-59"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="kd">::</span> <span class="n">applys</span>      <span class="o">=&gt;</span> <span class="n">psfun_d_serial_apply_sparse</span>
<a name="ln-60"></a>        <span class="k">generic</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">apply</span> <span class="o">=&gt;</span> <span class="n">applya</span><span class="p">,</span> <span class="n">applys</span>
<a name="ln-61"></a>    <span class="k">end type </span><span class="n">psfun_d_serial</span>
<a name="ln-62"></a>
<a name="ln-63"></a>    <span class="c">!!</span>
<a name="ln-64"></a>    <span class="c">!! For symmetric matrices we implement the Schur algorithm for the</span>
<a name="ln-65"></a>    <span class="c">!! computation of \(y=f(\alpha A)x\). For this reason we need the `psfun_d_serial`</span>
<a name="ln-66"></a>    <span class="c">!! type to have a member pointing to a function name for f. It is already</span>
<a name="ln-67"></a>    <span class="c">!! defined to get also a second optional argument that tells the function</span>
<a name="ln-68"></a>    <span class="c">!! to compute instead the kth derivative of f. This is done in light of</span>
<a name="ln-69"></a>    <span class="c">!! the nonsymmetric case in which the Schur-Parlett algorithm should be used</span>
<a name="ln-70"></a>    <span class="c">!! instead.</span>
<a name="ln-71"></a>    <span class="k">abstract interface</span>
<a name="ln-72"></a><span class="k">        function </span><span class="n">func</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-73"></a>            <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-74"></a>            <span class="k">implicit none</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="k">            </span><span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">func</span>
<a name="ln-77"></a>            <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">x</span>    <span class="c">!! Value to be computed</span>
<a name="ln-78"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">k</span>    <span class="c">!! Computes kth derivative \(f^{(k)}(x)\)</span>
<a name="ln-79"></a>        <span class="k">end function </span><span class="n">func</span>
<a name="ln-80"></a>    <span class="k">end interface</span>
<a name="ln-81"></a>
<a name="ln-82"></a><span class="k">    private</span> <span class="kd">::</span> <span class="n">psfun_d_setstring</span><span class="p">,</span> <span class="n">psfun_d_setreal</span><span class="p">,</span> <span class="n">psfun_d_setinteger</span><span class="p">,</span> <span class="n">psfun_d_setpointer</span>
<a name="ln-83"></a>
<a name="ln-84"></a><span class="k">contains</span>
<a name="ln-85"></a>
<a name="ln-86"></a><span class="k">    subroutine </span><span class="n">psfun_d_setstring</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">what</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-87"></a>        <span class="c">!! Set function for setting options defined by a string</span>
<a name="ln-88"></a>        <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-89"></a>        <span class="k">implicit none</span>
<a name="ln-90"></a>
<a name="ln-91"></a><span class="k">        class</span><span class="p">(</span><span class="n">psfun_d_serial</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fun</span>   <span class="c">!! Function object</span>
<a name="ln-92"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">what</span>  <span class="c">!! String of option to set</span>
<a name="ln-93"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! Value of the string</span>
<a name="ln-94"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">info</span>  <span class="c">!! Output flag</span>
<a name="ln-95"></a>
<a name="ln-96"></a>        <span class="n">info</span> <span class="o">=</span> <span class="n">psb_success_</span>
<a name="ln-97"></a>        <span class="k">select case</span> <span class="p">(</span><span class="n">psb_toupper</span><span class="p">(</span><span class="n">what</span><span class="p">))</span>
<a name="ln-98"></a>        <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;FNAME&quot;</span><span class="p">)</span>
<a name="ln-99"></a>            <span class="n">fun</span><span class="p">%</span><span class="n">fname</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-100"></a>        <span class="k">case</span> <span class="p">(</span><span class="s2">&quot;VARIANT&quot;</span><span class="p">)</span>
<a name="ln-101"></a>            <span class="n">fun</span><span class="p">%</span><span class="n">variant</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-102"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-103"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_invalid_args_combination_</span>
<a name="ln-104"></a>        <span class="k">end select</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="k">    end subroutine </span><span class="n">psfun_d_setstring</span>
<a name="ln-107"></a>
<a name="ln-108"></a>    <span class="k">subroutine </span><span class="n">psfun_d_setreal</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">what</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-109"></a>        <span class="c">!! Set function for setting options defined by a real</span>
<a name="ln-110"></a>        <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-111"></a>        <span class="k">implicit none</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="k">        class</span><span class="p">(</span><span class="n">psfun_d_serial</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fun</span>   <span class="c">!! Function object</span>
<a name="ln-114"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">what</span>  <span class="c">!! String of option to set</span>
<a name="ln-115"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! Real Value of the option</span>
<a name="ln-116"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">info</span>  <span class="c">!! Output flag</span>
<a name="ln-117"></a>
<a name="ln-118"></a>        <span class="n">info</span> <span class="o">=</span> <span class="n">psb_success_</span>
<a name="ln-119"></a>        <span class="k">select case</span> <span class="p">(</span><span class="n">psb_toupper</span><span class="p">(</span><span class="n">what</span><span class="p">))</span>
<a name="ln-120"></a>        <span class="k">case</span><span class="p">(</span><span class="s2">&quot;SCALING&quot;</span><span class="p">)</span>
<a name="ln-121"></a>            <span class="n">fun</span><span class="p">%</span><span class="n">scaling</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-122"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-123"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_invalid_args_combination_</span>
<a name="ln-124"></a>        <span class="k">end select</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="k">    end subroutine </span><span class="n">psfun_d_setreal</span>
<a name="ln-127"></a>
<a name="ln-128"></a>    <span class="k">subroutine </span><span class="n">psfun_d_setinteger</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">what</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-129"></a>        <span class="c">!! Set function for setting options defined by an integer</span>
<a name="ln-130"></a>        <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-131"></a>        <span class="k">implicit none</span>
<a name="ln-132"></a>
<a name="ln-133"></a><span class="k">        class</span><span class="p">(</span><span class="n">psfun_d_serial</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fun</span>   <span class="c">!! Function object</span>
<a name="ln-134"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">what</span>  <span class="c">!! String of option to set</span>
<a name="ln-135"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! Integer Value of the option</span>
<a name="ln-136"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">info</span>  <span class="c">!! Output flag</span>
<a name="ln-137"></a>
<a name="ln-138"></a>        <span class="n">info</span> <span class="o">=</span> <span class="n">psb_success_</span>
<a name="ln-139"></a>        <span class="k">select case</span> <span class="p">(</span><span class="n">psb_toupper</span><span class="p">(</span><span class="n">what</span><span class="p">))</span>
<a name="ln-140"></a>        <span class="k">case</span><span class="p">(</span><span class="s2">&quot;PADE_DEGREE&quot;</span><span class="p">)</span>
<a name="ln-141"></a>            <span class="n">fun</span><span class="p">%</span><span class="n">padedegree</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-142"></a><span class="cp">#if defined(WITHPHILIBRARY)</span>
<a name="ln-143"></a>        <span class="k">case</span><span class="p">(</span><span class="s2">&quot;PHIORDER&quot;</span><span class="p">)</span>
<a name="ln-144"></a>            <span class="n">fun</span><span class="p">%</span><span class="n">phiorder</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-145"></a><span class="cp">#endif</span>
<a name="ln-146"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-147"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_invalid_args_combination_</span>
<a name="ln-148"></a>        <span class="k">end select</span>
<a name="ln-149"></a>
<a name="ln-150"></a><span class="k">    end subroutine </span><span class="n">psfun_d_setinteger</span>
<a name="ln-151"></a>
<a name="ln-152"></a>    <span class="k">subroutine </span><span class="n">psfun_d_setpointer</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">what</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-153"></a>        <span class="c">!! To set the function pointer inside the type</span>
<a name="ln-154"></a>        <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-155"></a>        <span class="k">implicit none</span>
<a name="ln-156"></a>
<a name="ln-157"></a><span class="k">        class</span><span class="p">(</span><span class="n">psfun_d_serial</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fun</span>   <span class="c">!! Function object</span>
<a name="ln-158"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">what</span>  <span class="c">!! String of option to set</span>
<a name="ln-159"></a>        <span class="k">procedure</span> <span class="p">(</span><span class="n">func</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! Function to set</span>
<a name="ln-160"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">info</span>  <span class="c">!! Output flag</span>
<a name="ln-161"></a>
<a name="ln-162"></a>        <span class="n">info</span> <span class="o">=</span> <span class="n">psb_success_</span>
<a name="ln-163"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">psb_toupper</span><span class="p">(</span><span class="n">what</span><span class="p">))</span>
<a name="ln-164"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;FPOINTER&#39;</span><span class="p">)</span>
<a name="ln-165"></a>            <span class="n">fun</span><span class="p">%</span><span class="n">f_ptr</span> <span class="o">=&gt;</span> <span class="n">val</span>
<a name="ln-166"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-167"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_invalid_args_combination_</span>
<a name="ln-168"></a>        <span class="k">end select</span>
<a name="ln-169"></a>
<a name="ln-170"></a><span class="k">    end subroutine </span><span class="n">psfun_d_setpointer</span>
<a name="ln-171"></a>
<a name="ln-172"></a>    <span class="k">subroutine </span><span class="n">psfun_d_serial_apply_array</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-173"></a>        <span class="c">!! This is the core of the function apply on a serial matrix to compute</span>
<a name="ln-174"></a>        <span class="c">!! \(y = f(\alpha A) x\). It calls on the specific routines</span>
<a name="ln-175"></a>        <span class="c">!! implementing the different functions. It is the function to modify if</span>
<a name="ln-176"></a>        <span class="c">!! ones want to interface a new function that was not previously</span>
<a name="ln-177"></a>        <span class="c">!! available or a new algorithm (variant) for an already existing</span>
<a name="ln-178"></a>        <span class="c">!! function.</span>
<a name="ln-179"></a>        <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-180"></a><span class="cp">#if defined(WITHPHILIBRARY)</span>
<a name="ln-181"></a>        <span class="k">use </span><span class="n">scalesquare</span>
<a name="ln-182"></a><span class="cp">#endif</span>
<a name="ln-183"></a>        <span class="k">implicit none</span>
<a name="ln-184"></a>
<a name="ln-185"></a><span class="k">        class</span><span class="p">(</span><span class="n">psfun_d_serial</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fun</span> <span class="c">!! Function information</span>
<a name="ln-186"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">a</span><span class="p">(:,:)</span> <span class="c">!! Matrix</span>
<a name="ln-187"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">x</span><span class="p">(:)</span> <span class="c">!! Input vector</span>
<a name="ln-188"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">y</span><span class="p">(:)</span> <span class="c">!! Output vector</span>
<a name="ln-189"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">info</span> <span class="c">!! Information on the output</span>
<a name="ln-190"></a>
<a name="ln-191"></a>        <span class="c">!! local variables</span>
<a name="ln-192"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">lwsp</span><span class="p">,</span><span class="n">iexph</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">shapes</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">lwork</span>
<a name="ln-193"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">allocatable</span>     <span class="kd">::</span> <span class="n">fA</span><span class="p">(:,:),</span><span class="n">wsp</span><span class="p">(:),</span><span class="n">iwsp</span><span class="p">(:),</span><span class="n">phiA</span><span class="p">(:,:,:),</span><span class="n">work</span><span class="p">(:),</span><span class="n">ytmp</span><span class="p">(:)</span>
<a name="ln-194"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">allocatable</span>  <span class="kd">::</span> <span class="n">ipiv</span><span class="p">(:)</span>
<a name="ln-195"></a>        <span class="c">!! local constants</span>
<a name="ln-196"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">err_act</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-197"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">name</span>
<a name="ln-198"></a>
<a name="ln-199"></a>        <span class="n">info</span> <span class="o">=</span> <span class="n">psb_success_</span>
<a name="ln-200"></a>        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;psb_krylov&#39;</span>
<a name="ln-201"></a>        <span class="k">call </span><span class="n">psb_erractionsave</span><span class="p">(</span><span class="n">err_act</span><span class="p">)</span>
<a name="ln-202"></a>
<a name="ln-203"></a>
<a name="ln-204"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-205"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-206"></a>        <span class="k">if</span><span class="p">(</span> <span class="n">n</span> <span class="o">/=</span> <span class="n">m</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-207"></a><span class="k">            </span><span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_from_subroutine_</span>
<a name="ln-208"></a>            <span class="k">call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">fname</span><span class="p">))</span>
<a name="ln-209"></a>            <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-210"></a>        <span class="k">end if</span>
<a name="ln-211"></a><span class="k">        </span><span class="n">shapes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-212"></a>        <span class="n">shapes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">m</span>
<a name="ln-213"></a>
<a name="ln-214"></a>        <span class="k">select case</span> <span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">fname</span><span class="p">)</span>
<a name="ln-215"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;EXP&#39;</span><span class="p">)</span>
<a name="ln-216"></a>            <span class="k">select case</span> <span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">)</span>
<a name="ln-217"></a>            <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;TAYLOR&#39;</span><span class="p">)</span>
<a name="ln-218"></a>                <span class="c">!!</span>
<a name="ln-219"></a>                <span class="c">!! **INTERFACE** for the John Burkardt Taylor code for</span>
<a name="ln-220"></a>                <span class="c">!! the matrix exponential.</span>
<a name="ln-221"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">fA</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-222"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-223"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-224"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-225"></a>                <span class="k">end if</span>
<a name="ln-226"></a>
<a name="ln-227"></a><span class="k">                call </span><span class="n">r8mat_expm2</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">fA</span> <span class="p">)</span>
<a name="ln-228"></a>                <span class="n">y</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-229"></a>
<a name="ln-230"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">fA</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-231"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-232"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-233"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-234"></a>                <span class="k">end if</span>
<a name="ln-235"></a><span class="k">            case</span> <span class="p">(</span><span class="s1">&#39;SASQ&#39;</span><span class="p">)</span>
<a name="ln-236"></a>                <span class="c">!!</span>
<a name="ln-237"></a>                <span class="c">!! **INTERFACE** for the John Burkardt scaling and squaring code for</span>
<a name="ln-238"></a>                <span class="c">!! the matrix exponential.</span>
<a name="ln-239"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">fA</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-240"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-241"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-242"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-243"></a>                <span class="k">end if</span>
<a name="ln-244"></a>
<a name="ln-245"></a><span class="k">                call </span><span class="n">r8mat_expm1</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">fA</span> <span class="p">)</span>
<a name="ln-246"></a>                <span class="n">y</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-247"></a>
<a name="ln-248"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">fA</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-249"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-250"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-251"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-252"></a>                <span class="k">end if</span>
<a name="ln-253"></a><span class="k">            case</span><span class="p">(</span><span class="s1">&#39;GENPADE&#39;</span><span class="p">)</span>
<a name="ln-254"></a>                <span class="c">!!</span>
<a name="ln-255"></a>                <span class="c">!! **INTERFACE** for the EXPOKIT package computes the matrix</span>
<a name="ln-256"></a>                <span class="c">!! exponential using the irreducible rational Pade approximation</span>
<a name="ln-257"></a>                <span class="c">!! to the exponential function exp(x) = r(x) = (+/-)( I + 2*(q(x)/p(x)) ),</span>
<a name="ln-258"></a>                <span class="c">!! combined with scaling-and-squaring.</span>
<a name="ln-259"></a>                <span class="n">lwsp</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="n">fun</span><span class="p">%</span><span class="n">padedegree</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-260"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">(</span><span class="n">lwsp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-261"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-262"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-263"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-264"></a>                <span class="k">end if</span>
<a name="ln-265"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">ipiv</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-266"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-267"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-268"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-269"></a>                <span class="k">end if</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="k">                call </span><span class="n">DGPADM</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">padedegree</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">wsp</span><span class="p">,</span><span class="n">lwsp</span><span class="p">,</span><span class="n">ipiv</span><span class="p">,</span><span class="n">iexph</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-272"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-273"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-274"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-275"></a>                <span class="k">end if</span>
<a name="ln-276"></a>
<a name="ln-277"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">fA</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-278"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-279"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-280"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-281"></a>                <span class="k">end if</span>
<a name="ln-282"></a>
<a name="ln-283"></a><span class="k">                do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span>
<a name="ln-284"></a>                    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span>
<a name="ln-285"></a>                        <span class="n">fA</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">wsp</span><span class="p">(</span><span class="n">iexph</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-286"></a>                    <span class="k">end do</span>
<a name="ln-287"></a><span class="k">                end do</span>
<a name="ln-288"></a><span class="k">                </span><span class="n">y</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-289"></a>
<a name="ln-290"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">wsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-291"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-292"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-293"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-294"></a>                <span class="k">end if</span>
<a name="ln-295"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ipiv</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ipiv</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-296"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-297"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-298"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-299"></a>                <span class="k">end if</span>
<a name="ln-300"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">fA</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-301"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-302"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-303"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-304"></a>                <span class="k">end if</span>
<a name="ln-305"></a><span class="k">            case</span> <span class="p">(</span><span class="s2">&quot;CHBHES&quot;</span><span class="p">)</span>
<a name="ln-306"></a>                <span class="c">!!</span>
<a name="ln-307"></a>                <span class="c">!! **INTERFACE** for the EXPOKIT package computes the matrix</span>
<a name="ln-308"></a>                <span class="c">!! exponential using the partial fraction expansion of the</span>
<a name="ln-309"></a>                <span class="c">!! uniform rational Chebyshev approximation for an Hessenberg</span>
<a name="ln-310"></a>                <span class="c">!! matrix.</span>
<a name="ln-311"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-312"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-313"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-314"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-315"></a>                <span class="k">end if</span>
<a name="ln-316"></a>
<a name="ln-317"></a><span class="k">                </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-318"></a>                <span class="k">call </span><span class="n">DNCHBV</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wsp</span> <span class="p">)</span>
<a name="ln-319"></a>
<a name="ln-320"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">wsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-321"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-322"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-323"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-324"></a>                <span class="k">end if</span>
<a name="ln-325"></a>
<a name="ln-326"></a><span class="k">            case</span> <span class="p">(</span><span class="s2">&quot;CHBGEN&quot;</span><span class="p">)</span>
<a name="ln-327"></a>                <span class="c">!!</span>
<a name="ln-328"></a>                <span class="c">!! **INTERFACE** for the EXPOKIT package computes the matrix</span>
<a name="ln-329"></a>                <span class="c">!! exponential using the partial fraction expansion of the</span>
<a name="ln-330"></a>                <span class="c">!! uniform rational Chebyshev approximation for a general</span>
<a name="ln-331"></a>                <span class="c">!! matrix.</span>
<a name="ln-332"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-333"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-334"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-335"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-336"></a>                <span class="k">end if</span>
<a name="ln-337"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">iwsp</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-338"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-339"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-340"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-341"></a>                <span class="k">end if</span>
<a name="ln-342"></a>
<a name="ln-343"></a><span class="k">                </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-344"></a>                <span class="k">call </span><span class="n">DGCHBV</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wsp</span><span class="p">,</span> <span class="n">iwsp</span><span class="p">,</span> <span class="n">info</span> <span class="p">)</span>
<a name="ln-345"></a>
<a name="ln-346"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">wsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-347"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-348"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-349"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-350"></a>                <span class="k">end if</span>
<a name="ln-351"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">iwsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">iwsp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-352"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-353"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-354"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-355"></a>                <span class="k">end if</span>
<a name="ln-356"></a>
<a name="ln-357"></a><span class="k">            case</span> <span class="p">(</span><span class="s2">&quot;CHBSYM&quot;</span><span class="p">)</span>
<a name="ln-358"></a>                <span class="c">!!</span>
<a name="ln-359"></a>                <span class="c">!! **INTERFACE** for the EXPOKIT package computes the matrix</span>
<a name="ln-360"></a>                <span class="c">!! exponential using the partial fraction expansion of the</span>
<a name="ln-361"></a>                <span class="c">!! uniform rational Chebyshev approximation for a symmetric</span>
<a name="ln-362"></a>                <span class="c">!! matrix.</span>
<a name="ln-363"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-364"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-365"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-366"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-367"></a>                <span class="k">end if</span>
<a name="ln-368"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">iwsp</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-369"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-370"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-371"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-372"></a>                <span class="k">end if</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="k">                </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-375"></a>                <span class="k">call </span><span class="n">DSCHBV</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">wsp</span><span class="p">,</span> <span class="n">iwsp</span><span class="p">,</span> <span class="n">info</span> <span class="p">)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">wsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-378"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-379"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-380"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-381"></a>                <span class="k">end if</span>
<a name="ln-382"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">iwsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">iwsp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-383"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-384"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-385"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-386"></a>                <span class="k">end if</span>
<a name="ln-387"></a><span class="k">            case </span><span class="n">default</span>
<a name="ln-388"></a>                <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_from_subroutine_</span>
<a name="ln-389"></a>                <span class="k">call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-390"></a>                <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-391"></a>            <span class="k">end select</span>
<a name="ln-392"></a><span class="k">        case</span><span class="p">(</span><span class="s1">&#39;PHI&#39;</span><span class="p">)</span>
<a name="ln-393"></a><span class="cp">#if defined(WITHPHILIBRARY)</span>
<a name="ln-394"></a>            <span class="c">!!</span>
<a name="ln-395"></a>            <span class="c">!! **INTERFACE** to the œï-function from Koikari, Souji.</span>
<a name="ln-396"></a>            <span class="c">!!&quot;Algorithm 894: On a block Schur--Parlett algorithm</span>
<a name="ln-397"></a>            <span class="c">!! for œï-functions based on the sep-inverse estimate.&quot;</span>
<a name="ln-398"></a>            <span class="c">!!ACM Transactions on Mathematical Software (TOMS) 36.2</span>
<a name="ln-399"></a>            <span class="c">!! (2009): 1-20.</span>
<a name="ln-400"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">phiA</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">fun</span><span class="p">%</span><span class="n">phiorder</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-401"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-402"></a><span class="k">                call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-403"></a>                <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-404"></a>            <span class="k">end if</span>
<a name="ln-405"></a>
<a name="ln-406"></a><span class="k">            </span><span class="n">phiA</span> <span class="o">=</span> <span class="n">sasmtrphif</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">phiorder</span><span class="p">,</span><span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<a name="ln-407"></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">phiA</span><span class="p">(:,:,</span><span class="n">fun</span><span class="p">%</span><span class="n">phiorder</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
<a name="ln-408"></a>
<a name="ln-409"></a>            <span class="k">if</span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">phiA</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">phiA</span><span class="p">,</span><span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-410"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-411"></a><span class="k">                call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-412"></a>                <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-413"></a>            <span class="k">end if</span>
<a name="ln-414"></a><span class="cp">#else</span>
<a name="ln-415"></a>            <span class="k">write</span><span class="p">(</span><span class="n">psb_err_unit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;Warning: no suitable PHIFUNCTION interface&#39;</span>
<a name="ln-416"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_from_subroutine_</span>
<a name="ln-417"></a>            <span class="k">call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-418"></a>            <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-419"></a><span class="cp">#endif</span>
<a name="ln-420"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;USERF&#39;</span><span class="p">)</span>
<a name="ln-421"></a>            <span class="k">select case</span> <span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">)</span>
<a name="ln-422"></a>            <span class="k">case</span><span class="p">(</span><span class="s1">&#39;SYM&#39;</span><span class="p">)</span>
<a name="ln-423"></a>                <span class="c">!!</span>
<a name="ln-424"></a>                <span class="c">!! For a symmetric matrix we need only to compute the function</span>
<a name="ln-425"></a>                <span class="c">!! values, and not also its derivatives. We use LAPACK to compute</span>
<a name="ln-426"></a>                <span class="c">!! the Schur decomposition of the input matrix, apply f on the</span>
<a name="ln-427"></a>                <span class="c">!! eigenvalues and return the computation</span>
<a name="ln-428"></a>
<a name="ln-429"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">fA</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">),</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">info</span><span class="p">)</span>
<a name="ln-430"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-431"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-432"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-433"></a>                <span class="k">end if</span>
<a name="ln-434"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">info</span><span class="p">)</span> <span class="c">! Will contain the eigenvalues</span>
<a name="ln-435"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-436"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-437"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-438"></a>                <span class="k">end if</span>
<a name="ln-439"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">ytmp</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-440"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-441"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-442"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-443"></a>                <span class="k">end if</span>
<a name="ln-444"></a>
<a name="ln-445"></a><span class="k">                </span><span class="n">fA</span> <span class="o">=</span> <span class="n">a</span> <span class="c">! We need to work on a copy of a since the Lapack routine</span>
<a name="ln-446"></a>                       <span class="c">! will destroy it</span>
<a name="ln-447"></a>
<a name="ln-448"></a>                <span class="c">! First we query the Lapack routine for the size of the</span>
<a name="ln-449"></a>                <span class="c">! auxiliary working vectors</span>
<a name="ln-450"></a>                <span class="k">allocate</span><span class="p">(</span><span class="n">work</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">info</span><span class="p">)</span>
<a name="ln-451"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-452"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-453"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-454"></a>                <span class="k">end if</span>
<a name="ln-455"></a>
<a name="ln-456"></a><span class="k">                call </span><span class="n">DSYEV</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">fA</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">wsp</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-457"></a>                <span class="n">lwork</span> <span class="o">=</span> <span class="n">work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Store the optimal work-size</span>
<a name="ln-458"></a>                <span class="c">! We free the dummy work vectors and the reallocate them to the</span>
<a name="ln-459"></a>                <span class="c">! corrected size</span>
<a name="ln-460"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">work</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-461"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-462"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-463"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-464"></a>                <span class="k">end if</span>
<a name="ln-465"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">work</span><span class="p">(</span><span class="n">lwork</span><span class="p">),</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">info</span><span class="p">)</span>
<a name="ln-466"></a>                <span class="c">! We can now do the proper computation</span>
<a name="ln-467"></a>                <span class="k">call </span><span class="n">DSYEV</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">fA</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">wsp</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="n">lwork</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-468"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-469"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-470"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-471"></a>                <span class="k">end if</span>
<a name="ln-472"></a>                <span class="c">! a = fA diag(wsp) fA^T in three steps</span>
<a name="ln-473"></a>                <span class="k">call </span><span class="n">DGEMV</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">fA</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dzero</span><span class="p">,</span> <span class="n">ytmp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! ytmp = A^t x</span>
<a name="ln-474"></a>                <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span>
<a name="ln-475"></a>                    <span class="n">ytmp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">fun</span><span class="p">%</span><span class="n">f_ptr</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">scaling</span><span class="o">*</span><span class="n">wsp</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">ytmp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>      <span class="c">! ytmp(i) = f(Œ± Œª_i) ytmp(i)</span>
<a name="ln-476"></a>                <span class="k">end do</span>
<a name="ln-477"></a><span class="k">                call </span><span class="n">DGEMV</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">fA</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ytmp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dzero</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! y = A ytmp</span>
<a name="ln-478"></a>
<a name="ln-479"></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">fA</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">fA</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-480"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-481"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-482"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-483"></a>                <span class="k">end if</span>
<a name="ln-484"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">wsp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">wsp</span><span class="p">,</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">info</span> <span class="p">)</span>
<a name="ln-485"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-486"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-487"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-488"></a>                <span class="k">end if</span>
<a name="ln-489"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">work</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">info</span><span class="p">)</span>
<a name="ln-490"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-491"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-492"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-493"></a>                <span class="k">end if</span>
<a name="ln-494"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ytmp</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ytmp</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-495"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-496"></a><span class="k">                    call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-497"></a>                    <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-498"></a>                <span class="k">end if</span>
<a name="ln-499"></a><span class="k">            case </span><span class="n">default</span>
<a name="ln-500"></a>                <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_from_subroutine_</span>
<a name="ln-501"></a>                <span class="k">call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">variant</span><span class="p">))</span>
<a name="ln-502"></a>                <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-503"></a>            <span class="k">end select</span>
<a name="ln-504"></a><span class="k">        case </span><span class="n">default</span>
<a name="ln-505"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_from_subroutine_</span>
<a name="ln-506"></a>            <span class="k">call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">fname</span><span class="p">))</span>
<a name="ln-507"></a>            <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-508"></a>        <span class="k">end select</span>
<a name="ln-509"></a>
<a name="ln-510"></a><span class="k">        if</span><span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="n">psb_success_</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-511"></a><span class="k">          </span><span class="n">info</span> <span class="o">=</span> <span class="n">psb_err_from_subroutine_</span>
<a name="ln-512"></a>          <span class="k">call </span><span class="n">psb_errpush</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a_err</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">fun</span><span class="p">%</span><span class="n">fname</span><span class="p">))</span>
<a name="ln-513"></a>          <span class="k">goto </span><span class="mi">9999</span>
<a name="ln-514"></a>        <span class="k">end if</span>
<a name="ln-515"></a>
<a name="ln-516"></a><span class="k">        call </span><span class="n">psb_erractionrestore</span><span class="p">(</span><span class="n">err_act</span><span class="p">)</span>
<a name="ln-517"></a>        <span class="k">return</span>
<a name="ln-518"></a>
<a name="ln-519"></a><span class="k">        </span><span class="mi">9999</span> <span class="k">continue</span>
<a name="ln-520"></a>
<a name="ln-521"></a><span class="k">        return</span>
<a name="ln-522"></a>
<a name="ln-523"></a><span class="k">    end subroutine </span><span class="n">psfun_d_serial_apply_array</span>
<a name="ln-524"></a>
<a name="ln-525"></a>    <span class="k">subroutine </span><span class="n">psfun_d_serial_apply_sparse</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-526"></a>        <span class="c">!! This is the core of the function apply on a serial matrix to compute</span>
<a name="ln-527"></a>        <span class="c">!! \(y = f(\alpha*A) x\) when A is memorized in a sparse storage.</span>
<a name="ln-528"></a>        <span class="c">!! In this case the routine converts it to a dense storage and then calls</span>
<a name="ln-529"></a>        <span class="c">!! the array version of itself. That is the one implementing the</span>
<a name="ln-530"></a>        <span class="c">!! different functions. It is the function to modify if ones want to</span>
<a name="ln-531"></a>        <span class="c">!! interface a new function that was not previously available or a new</span>
<a name="ln-532"></a>        <span class="c">!! algorithm (variant) for an already existing function.</span>
<a name="ln-533"></a>        <span class="k">use </span><span class="n">psb_base_mod</span>
<a name="ln-534"></a>        <span class="k">implicit none</span>
<a name="ln-535"></a>
<a name="ln-536"></a><span class="k">        class</span><span class="p">(</span><span class="n">psfun_d_serial</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fun</span>  <span class="c">!! Function information</span>
<a name="ln-537"></a>        <span class="k">type</span><span class="p">(</span><span class="n">psb_dspmat_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>    <span class="c">!! Matrix</span>
<a name="ln-538"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">x</span><span class="p">(:)</span> <span class="c">!! Input vector</span>
<a name="ln-539"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">y</span><span class="p">(:)</span> <span class="c">!! Output vector</span>
<a name="ln-540"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">info</span> <span class="c">!! Information on the output</span>
<a name="ln-541"></a>
<a name="ln-542"></a>        <span class="c">! local variables</span>
<a name="ln-543"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">amat</span><span class="p">(:,:)</span>
<a name="ln-544"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">psb_ipk_</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span><span class="p">,</span><span class="n">nnz</span><span class="p">,</span><span class="n">i</span>
<a name="ln-545"></a>        <span class="k">type</span><span class="p">(</span><span class="n">psb_d_coo_sparse_mat</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">acoo</span>
<a name="ln-546"></a>
<a name="ln-547"></a>        <span class="k">call </span><span class="n">a</span><span class="p">%</span><span class="n">a</span><span class="p">%</span><span class="n">cp_to_coo</span><span class="p">(</span><span class="n">acoo</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-548"></a>        <span class="k">if</span><span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="n">psb_success_</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">psb_err_unit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;Error in Copy to COO&quot;</span>
<a name="ln-549"></a>
<a name="ln-550"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="p">%</span><span class="n">get_nrows</span><span class="p">()</span>
<a name="ln-551"></a>        <span class="n">nnz</span> <span class="o">=</span> <span class="n">acoo</span><span class="p">%</span><span class="n">get_nzeros</span><span class="p">()</span>
<a name="ln-552"></a>
<a name="ln-553"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">amat</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-554"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">psb_err_unit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;amat: Allocation request denied&quot;</span>
<a name="ln-555"></a>
<a name="ln-556"></a>        <span class="n">amat</span> <span class="o">=</span> <span class="mi">0_psb_dpk_</span>
<a name="ln-557"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nnz</span><span class="p">,</span> <span class="mi">1</span>
<a name="ln-558"></a>            <span class="n">amat</span><span class="p">(</span><span class="n">acoo</span><span class="p">%</span><span class="n">ia</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">acoo</span><span class="p">%</span><span class="n">ja</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">=</span> <span class="n">acoo</span><span class="p">%</span><span class="n">val</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-559"></a>        <span class="k">end do</span>
<a name="ln-560"></a>
<a name="ln-561"></a><span class="k">        call </span><span class="n">fun</span><span class="p">%</span><span class="n">apply</span><span class="p">(</span><span class="n">amat</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-562"></a>
<a name="ln-563"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">amat</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">amat</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">info</span><span class="p">)</span>
<a name="ln-564"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">psb_err_unit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;amat: Deallocation request denied&quot;</span>
<a name="ln-565"></a>
<a name="ln-566"></a>        <span class="k">return</span>
<a name="ln-567"></a>
<a name="ln-568"></a><span class="k">    end subroutine </span><span class="n">psfun_d_serial_apply_sparse</span>
<a name="ln-569"></a>
<a name="ln-570"></a><span class="k">end module </span><span class="n">psfun_d_serial_mod</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> PSFUN was developed by Fabio Durastante</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>